/**
 * tinyPubSub.js
 *
 * jQuery Tiny Pub/Sub - v0.7 - 10/27/2011
 * http://benalman.com/
 * Copyright (c) 2011 "Cowboy" Ben Alman; Licensed MIT, GPL 
 */

define("tinyPubSub",["jquery"],function(){var e=$({});$.subscribe=function(){e.on.apply(e,arguments)},$.unsubscribe=function(){e.off.apply(e,arguments)},$.publish=function(){e.trigger.apply(e,arguments)}}),define("watchdog",["jquery","tinyPubSub"],function(){"use strict";var e=["pr:jsonLoadError","pr:jsonLoadSuccess","pr:query"],t=function(e){$.subscribe(e,function(t,n){console.groupCollapsed(e),console.log(n),console.groupEnd()})};for(var n=0,r=e.length;n<r;n++)t(e[n]);console.log("Watchdog watching!",e)}),define("constants",[],function(){"use strict";var e={QUERY_LIMIT_DEFAULT:2,ERROR_DEFAULT:"We're sorry, but something went wrong.",SCROLL_BUFFER_PX:200,getPressReleaseQueryUrl:function(e,t){return"http://www.stellarbiotechnologies.com/media/press-releases/json?offset="+t+"&limit="+e}};return e}),require(["constants","jquery","tinyPubSub"],function(e){"use strict";var t=!1;$(function(){$.publish("pr:query",{offset:0,limit:10}),$(window).scroll(function(){var n=$(window);if(t)return;n.scrollTop()+n.height()>$(document).height()-e.SCROLL_BUFFER_PX&&($.publish("pr:query",{offset:$(".pr-item").length}),t=!0)})}),$.subscribe("pr:jsonLoadSuccess",function(e,n){t=!1})}),define("pageActions",function(){}),require(["constants","jquery","tinyPubSub"],function(e){"use strict";var t=function(t){var n=t.offset||0,r=t.limit||e.QUERY_LIMIT_DEFAULT,i=e.getPressReleaseQueryUrl(r,n);$.ajax({url:i,dataType:"JSON",type:"GET"}).done(function(e){$.publish("pr:jsonLoadSuccess",e)})};$.subscribe("pr:query",function(e,n){t(n)})}),define("pressReleaseService",function(){}),function(){var e={};this.tmpl=function t(n,r){var i=/\W/.test(n)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):e[n]=e[n]||t(document.getElementById(n).innerHTML);return r?i(r):i}}(),define("microtemplate",function(){}),Date.prototype.formatDate=function(e){var t=this,n=t.getDate(),r=t.getMonth()+1,i=t.getFullYear(),s=t.getHours(),o=t.getMinutes(),u=t.getSeconds();return e||(e="MM/dd/yyyy"),e=e.replace("MM",r.toString().replace(/^(\d)$/,"0$1")),e.indexOf("yyyy")>-1?e=e.replace("yyyy",i.toString()):e.indexOf("yy")>-1&&(e=e.replace("yy",i.toString().substr(2,2))),e=e.replace("dd",n.toString().replace(/^(\d)$/,"0$1")),e.indexOf("t")>-1&&(s>11?e=e.replace("t","pm"):e=e.replace("t","am")),e.indexOf("HH")>-1&&(e=e.replace("HH",s.toString().replace(/^(\d)$/,"0$1"))),e.indexOf("hh")>-1&&(s>12&&(s-=12),s===0&&(s=12),e=e.replace("hh",s.toString().replace(/^(\d)$/,"0$1"))),e.indexOf("mm")>-1&&(e=e.replace("mm",o.toString().replace(/^(\d)$/,"0$1"))),e.indexOf("ss")>-1&&(e=e.replace("ss",u.toString().replace(/^(\d)$/,"0$1"))),e},define("dateFormat",function(){}),require(["jquery","microtemplate","tinyPubSub","dateFormat"],function(){"use strict";var e=function(e){var t=new Date(e);return t.formatDate("hh:mmt on MM/dd/yyyy")};$.subscribe("pr:jsonLoadSuccess",function(t,n){var r=n.news.map(function(t){return t.publishDate=e(t.published),tmpl("tmpl_prItem",t)}).join("");$(".pr-list").append(r)})}),define("pressReleaseListUIUpdater",function(){}),require(["jquery","microtemplate","tinyPubSub"],function(){"use strict";$.subscribe("pr:query",function(e,t){$(".icon-spinner").show()}),$.subscribe("pr:jsonLoadSuccess",function(e,t){$(".icon-spinner").hide()})}),define("spinnerUIUpdater",function(){}),require.config({paths:{jquery:"https://code.jquery.com/jquery-2.1.4.min",microtemplate:"libs/microtemplate",tinyPubSub:"libs/tinyPubSub",dateFormat:"libs/simpleDateFormat",constants:"utils/constants",watchdog:"utils/watchdog"}}),require(["watchdog","pageActions","pressReleaseService","pressReleaseListUIUpdater","spinnerUIUpdater"]),define("app",function(){});